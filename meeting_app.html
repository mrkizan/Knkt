<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knkt</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        nav {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        nav h1 {
            color: white;
            margin: 0;
            font-size: 24px;
        }
        nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            gap: 20px;
        }
        nav a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s;
        }
        nav a:hover {
            color: #f0f0f0;
        }
        .section {
            display: none;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            flex-grow: 1;
        }
        .section.active {
            display: block;
        }
        #home {
            text-align: center;
            color: white;
            padding-top: 50px;
        }
        #home h2 {
            font-size: 48px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        #home p {
            font-size: 20px;
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        #home .features {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        .feature {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            width: 200px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .feature h3 {
            margin-top: 0;
        }
        button {
            padding: 15px 30px;
            background: linear-gradient(45deg, #28a745, #218838);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        button:hover {
            background: linear-gradient(45deg, #218838, #1e7e34);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        #meeting h1 {
            color: white;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 20px;
        }
        #meeting p {
            color: #f0f0f0;
            text-align: center;
            margin-bottom: 30px;
        }
        #videos {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            justify-items: center;
        }
        .video-container {
            position: relative;
            width: 100%;
            max-width: 400px;
        }
        .video-label {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
        }
        video {
            width: 100%;
            height: 250px;
            border: 3px solid #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            background-color: #000;
        }
        #remoteVideo::before {
            content: "Waiting for connection...";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 16px;
            pointer-events: none;
        }
        #controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        #muteAudio.muted {
            background: linear-gradient(45deg, #dc3545, #c82333);
            border: 2px solid #ff0000;
        }
        #connection-section {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
        }
        textarea {
            width: 100%;
            height: 120px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-family: monospace;
            resize: vertical;
            background-color: #f9f9f9;
        }
        #copyButton, #clearButton {
            margin-top: 10px;
            background: linear-gradient(45deg, #007bff, #0056b3);
        }
        #about {
            color: white;
            text-align: center;
        }
        #about h2 {
            font-size: 36px;
            margin-bottom: 20px;
        }
        #about p {
            max-width: 800px;
            margin: 0 auto 30px;
            font-size: 18px;
        }
        .faq {
            text-align: left;
            max-width: 800px;
            margin: 0 auto;
        }
        .faq h3 {
            margin-top: 30px;
        }
        .faq p {
            margin-bottom: 20px;
        }
        footer {
            text-align: center;
            color: #f0f0f0;
            padding: 20px;
            background: rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <nav>
        <h1>Knkt</h1>
        <ul>
            <li><a href="#" onclick="showSection('home')">Home</a></li>
            <li><a href="#" onclick="showSection('meeting')">Meeting</a></li>
            <li><a href="#" onclick="showSection('about')">About</a></li>
        </ul>
    </nav>

    <div id="home" class="section active">
        <h2>Welcome to Knkt</h2>
        <p>Secure, peer-to-peer video meetings in your browser. No servers, no sign-upsâ€”just instant connections.</p>
        <div class="features">
            <div class="feature">
                <h3>ðŸ”’ Secure</h3>
                <p>End-to-end encrypted calls with base64 codes.</p>
            </div>
            <div class="feature">
                <h3>ðŸ“¹ Easy</h3>
                <p>Start camera, share code, and connect in seconds.</p>
            </div>
            <div class="feature">
                <h3>ðŸš€ Fast</h3>
                <p>Direct peer-to-peer for lag-free video chats.</p>
            </div>
        </div>
        <button onclick="showSection('meeting')">Get Started</button>
    </div>

    <div id="meeting" class="section">
        <h1>Knkt Meeting</h1>
        <p>A simple peer-to-peer video meeting tool. Share the connection code with another user to connect.</p>
        
        <div id="videos">
            <div class="video-container">
                <div class="video-label">Your Video</div>
                <video id="localVideo" autoplay muted></video>
            </div>
            <div class="video-container">
                <div class="video-label">Remote Video</div>
                <video id="remoteVideo" autoplay></video>
            </div>
        </div>
        
        <div id="controls">
            <button id="startCamera">Start Camera</button>
            <button id="stopCamera">Stop Camera</button>
            <button id="muteAudio">Mute Audio</button>
            <button id="shareScreen">Share Screen</button>
            <button id="createOffer">Create Meeting (Host)</button>
            <button id="joinMeeting">Join Meeting (Guest)</button>
        </div>
        
        <div id="connection-section">
            <label>Connection Code . Host: Generate and share. Guest: Paste host's code, join, then share the new code back to host.:</label>
            <textarea id="offerTextarea" placeholder="Code will appear here after creating a meeting, or paste a code to join"></textarea>
            <button id="copyButton">Copy Code</button>
            <button id="clearButton">Clear Code</button>
        </div>
    </div>

    <div id="about" class="section">
        <h2>About Knkt</h2>
        <p>Knkt is a privacy-first video meeting app built for secure, direct connections. Unlike other apps, it runs entirely in your browser with no data stored on servers. Perfect for private calls, remote work, or catching up with friends.</p>
        <p>Developed with WebRTC and vanilla JavaScript, Knkt emphasizes security through base64-encoded signaling and peer-to-peer encryption. Contact the author for permissions or contributions.</p>
        
        <div class="faq">
            <h3>FAQ</h3>
            <h4>Is Knkt secure?</h4>
            <p>Yes! All calls are end-to-end encrypted via WebRTC. Codes are base64-encoded for added security.</p>
            <h4>How do I connect?</h4>
            <p>Host creates a code, shares it; guest pastes and joins, then shares back. Full steps in the Meeting page.</p>
            <h4>Does it work on mobile?</h4>
            <p>Yes, in modern browsers, but camera access may vary.</p>
            <h4>Can I use it offline?</h4>
            <p>No, internet is needed for connection setup.</p>
        </div>
    </div>

    <footer>&copy; 2026 KNKT. Stay safe and connected.</footer>

    <script>
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
        }

        let localStream;
        let peerConnection;
        let isMuted = false;
        const localVideo = document.getElementById('localVideo');
        const remoteVideo = document.getElementById('remoteVideo');
        const offerTextarea = document.getElementById('offerTextarea');
        const copyButton = document.getElementById('copyButton');
        const clearButton = document.getElementById('clearButton');
        const muteButton = document.getElementById('muteAudio');
        const config = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };
        
        document.getElementById('startCamera').onclick = async () => {
            try {
                localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                localVideo.srcObject = localStream;
            } catch (err) {
                alert('Error accessing camera/microphone: ' + err.message);
            }
        };
        
        document.getElementById('stopCamera').onclick = () => {
            if (localStream) {
                localStream.getTracks().forEach(track => track.stop());
                localVideo.srcObject = null;
            }
        };
        
        muteButton.onclick = () => {
            if (!localStream) return;
            if (isMuted) {
                localStream.getAudioTracks()[0].enabled = true;
                isMuted = false;
                muteButton.textContent = 'Mute Audio';
                muteButton.classList.remove('muted');
            } else {
                localStream.getAudioTracks()[0].enabled = false;
                isMuted = true;
                muteButton.textContent = 'Unmute Audio';
                muteButton.classList.add('muted');
            }
        };
        
        document.getElementById('shareScreen').onclick = async () => {
            try {
                const screenStream = await navigator.mediaDevices.getDisplayMedia({ video: true });
                localVideo.srcObject = screenStream;
                // Stop screen sharing when tracks end (e.g., user stops sharing)
                screenStream.getVideoTracks()[0].addEventListener('ended', async () => {
                    // Restore camera
                    if (localStream) {
                        localVideo.srcObject = localStream;
                    } else {
                        // Restart camera if not active
                        try {
                            localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                            localVideo.srcObject = localStream;
                        } catch (err) {
                            alert('Error restarting camera: ' + err.message);
                        }
                    }
                });
            } catch (err) {
                alert('Error sharing screen: ' + err.message);
            }
        };
        
        document.getElementById('createOffer').onclick = async () => {
            if (!localStream) { alert('Start camera first!'); return; }
            peerConnection = new RTCPeerConnection(config);
            localStream.getTracks().forEach(track => peerConnection.addTrack(track, localStream));
            peerConnection.ontrack = event => {
                remoteVideo.srcObject = event.streams[0];
                remoteVideo.style.position = 'relative';
            };
            peerConnection.onicecandidate = event => {
                if (event.candidate) return;
                const offer = peerConnection.localDescription;
                offerTextarea.value = btoa(JSON.stringify(offer));
            };
            const offer = await peerConnection.createOffer();
            await peerConnection.setLocalDescription(offer);
        };
        
        document.getElementById('joinMeeting').onclick = async () => {
            if (!localStream) { alert('Start camera first!'); return; }
            const offer = JSON.parse(atob(offerTextarea.value));
            peerConnection = new RTCPeerConnection(config);
            localStream.getTracks().forEach(track => peerConnection.addTrack(track, localStream));
            peerConnection.ontrack = event => {
                remoteVideo.srcObject = event.streams[0];
                remoteVideo.style.position = 'relative';
            };
            peerConnection.onicecandidate = event => {
                if (event.candidate) return;
                const answer = peerConnection.localDescription;
                offerTextarea.value = btoa(JSON.stringify(answer));
            };
            await peerConnection.setRemoteDescription(offer);
            const answer = await peerConnection.createAnswer();
            await peerConnection.setLocalDescription(answer);
        };
        
        offerTextarea.oninput = async () => {
            if (peerConnection && peerConnection.signalingState === 'have-local-offer') {
                try {
                    const answer = JSON.parse(atob(offerTextarea.value));
                    await peerConnection.setRemoteDescription(answer);
                } catch (e) { }
            }
        };
        
        copyButton.onclick = () => {
            offerTextarea.select();
            document.execCommand('copy');
            alert('Code copied to clipboard!');
        };
        
        clearButton.onclick = () => {
            offerTextarea.value = '';
        };
    </script>
</body>
</html>